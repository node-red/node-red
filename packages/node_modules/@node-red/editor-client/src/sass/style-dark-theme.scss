/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/

// Dark Theme Variables
:root {
    // Base colors
    --red-ui-primary-background: #1e1e1e;
    --red-ui-secondary-background: #252526;
    --red-ui-tertiary-background: #333333;

    // Text colors
    --red-ui-primary-text-color: white;
    --red-ui-secondary-text-color: white;
    --red-ui-tertiary-text-color: white;
    --red-ui-header-text-color: #ffffff;

    // Border colors
    --red-ui-primary-border-color: #444444;
    --red-ui-secondary-border-color: #555555;
    --red-ui-tertiary-border-color: #666666;

    // Form elements
    --red-ui-form-background: var(--red-ui-secondary-background);
    --red-ui-form-text-color: var(--red-ui-primary-text-color);
    --red-ui-form-placeholder-color: #888888;
    --red-ui-form-input-background: #3c3c3c;
    --red-ui-form-input-border-color: #555555;
    --red-ui-form-input-focus-color: rgba(14, 99, 156, 0.8);
    --red-ui-form-input-border-selected-color: #0e639c;

    // Button colors
    --red-ui-workspace-button-background: #3c3c3c;
    --red-ui-workspace-button-background-hover: #4c4c4c;
    --red-ui-workspace-button-background-active: #565656;
    --red-ui-workspace-button-background-primary: #0e639c;
    --red-ui-workspace-button-background-primary-hover: #1177bb;
    --red-ui-workspace-button-color: #cccccc;
    --red-ui-workspace-button-color-primary: #ffffff;

    // Sidebar/Tree
    --red-ui-palette-header-background: #252526;
    --red-ui-palette-content-background: #252526;

    // Editor colors
    --red-ui-text-editor-background: #1e1e1e;
    --red-ui-text-editor-color: #d4d4d4;
    --red-ui-text-editor-active-line-background: #282828;
    --red-ui-text-editor-gutter-background: #252526;
    --red-ui-text-editor-gutter-color: #858585;
    --red-ui-text-editor-selection-background: #264f78;

    // Node colors
    --red-ui-node-border: #777777;
    --red-ui-node-background-placeholder: #404040;
    --red-ui-node-label-color: white;
    
    // Syntax highlighting
    --red-ui-text-color-code: #ce9178;
    --red-ui-text-color-link: #4fc1ff;

    // Tab colors
    --red-ui-tab-background: var(--red-ui-secondary-background);
    --red-ui-tab-background-active: #1e1e1e;
    --red-ui-tab-text-color-active: #ffffff;
    --red-ui-tab-text-color-inactive: #bbbbbb;

    // Shadow
    --red-ui-shadow: rgba(0, 0, 0, 0.5);

    // Specific colors
    --red-ui-spinner-color: #0e639c;
    --red-ui-view-grid-color: #333333;
    --red-ui-diff-state-changed: #dcb862;
    --red-ui-diff-state-added: #4B8400;
    --red-ui-diff-state-deleted: #f44747;
    
    // List item
    --red-ui-list-item-background: var(--red-ui-secondary-background);
    --red-ui-list-item-background-hover: #2a2d2e;
    --red-ui-list-item-background-selected: #094771;
    --red-ui-list-item-color: var(--red-ui-primary-text-color);
    --red-ui-list-item-secondary-color: var(--red-ui-secondary-text-color);
}

// Main body and UI tweaks
body {
    background-color: var(--red-ui-primary-background);
    color: var(--red-ui-primary-text-color);
}

.red-ui-editor, 
.red-ui-workspace {
    background-color: var(--red-ui-primary-background);
}

#red-ui-workspace {
    border-color: var(--red-ui-primary-border-color);
}

.red-ui-header {
    background-color: var(--red-ui-secondary-background);
    border-bottom: 1px solid var(--red-ui-primary-border-color);
    color: var(--red-ui-header-text-color);
}

.red-ui-search-container {
    background: var(--red-ui-secondary-background);
}

.red-ui-menu-dropdown-container {
    background: var(--red-ui-secondary-background);
    border: 1px solid var(--red-ui-primary-border-color);
    box-shadow: 0 0 5px var(--red-ui-shadow);
}

// Button and UI element overrides
.red-ui-button {
    color: var(--red-ui-workspace-button-color);
    background: var(--red-ui-workspace-button-background);
    border-color: var(--red-ui-primary-border-color);
    
    &:hover {
        background: var(--red-ui-workspace-button-background-hover);
    }
    
    &:active {
        background: var(--red-ui-workspace-button-background-active);
    }

    &.primary {
        background: var(--red-ui-workspace-button-background-primary);
        color: var(--red-ui-workspace-button-color-primary);
        
        &:hover {
            background: var(--red-ui-workspace-button-background-primary-hover);
        }
    }

    border-radius: 4px !important;
    font-weight: 500 !important;
    letter-spacing: -0.01em !important;
}

// Links
a {
    color: var(--red-ui-text-color-link);
    
    &:hover {
        color: lighten(#4fc1ff, 10%);
    }
}

// Scrollbar styling
::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

::-webkit-scrollbar-track {
    background: var(--red-ui-secondary-background);
}

::-webkit-scrollbar-thumb {
    background: #555555;
    border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
    background: #666666;
}

// Syntax highlighting overrides for code areas
.ace_editor {
    background-color: var(--red-ui-text-editor-background) !important;
    color: var(--red-ui-text-editor-color) !important;
    
    .ace_gutter {
        background-color: var(--red-ui-text-editor-gutter-background) !important;
        color: var(--red-ui-text-editor-gutter-color) !important;
    }
    
    .ace_selection {
        background-color: var(--red-ui-text-editor-selection-background) !important;
    }
}

// Custom syntax highlighting - mimicking VS Code dark theme
.ace_keyword, .ace_storage {
    color: #569cd6 !important; // blue for keywords
}

.ace_string {
    color: #ce9178 !important; // orange for strings
}

.ace_comment {
    color: #6a9955 !important; // green for comments
}

.ace_constant.ace_numeric {
    color: #b5cea8 !important; // light green for numbers
}

.ace_support.ace_function {
    color: #dcdcaa !important; // yellow for functions
}

.ace_identifier, .ace_variable {
    color: #9cdcfe !important; // light blue for variables
}

.ace_operator {
    color: #d4d4d4 !important; // white-ish for operators
}

.ace_property {
    color: #9cdcfe !important; // light blue for properties
}

// Adjust node appearance
.red-ui-flow-node {
    background: #4A6DA7 !important; // Modern blue for all nodes
    
    .red-ui-flow-node-icon,
    .red-ui-flow-node-icon-container {
        background: #3A5A8C !important; // Slightly darker blue for icons
    }
    
    // Style the label for all nodes
    .red-ui-flow-node-label {
        color: #FFFFFF !important; // White text for all nodes
        font-weight: 500 !important;
        letter-spacing: -0.01em !important;
        text-shadow: 0 1px 1px rgba(0,0,0,0.2) !important;
    }
    
    // Fix icon coloring for all nodes
    .red-ui-flow-node-icon {
        fill: #FFFFFF !important; // White icons for all nodes
    }
    
    // Special styling for comment node only
    &.red-ui-flow-node-comment {
        background: rgba(74, 109, 167, 0.4) !important; // Transparent version of the same blue
        border: 1px solid rgba(58, 90, 140, 0.6) !important;
        
        .red-ui-flow-node-label {
            color: #FFFFFF !important;
        }
    }
}

// Sidebar panel tweaks
.red-ui-sidebar {
    background: var(--red-ui-secondary-background);
    border-left: 1px solid var(--red-ui-primary-border-color);
}

.red-ui-sidebar-header {
    background: var(--red-ui-palette-header-background);
    color: var(--red-ui-header-text-color);
    border-bottom: 1px solid var(--red-ui-primary-border-color);
}

.red-ui-palette {
    background: var(--red-ui-secondary-background);
}

.red-ui-palette-header {
    background: var(--red-ui-palette-header-background);
    color: var(--red-ui-header-text-color);
    border-bottom: 1px solid var(--red-ui-primary-border-color);
}

.red-ui-palette-category {
    background: var(--red-ui-tertiary-background);
    border: 1px solid var(--red-ui-primary-border-color);
    
    .red-ui-palette-header {
        background: var(--red-ui-secondary-background);
    }
}

// File tree and project navigator
.red-ui-projects-dialog-file-list-tree {
    background: var(--red-ui-secondary-background);
    color: var(--red-ui-primary-text-color);
    
    .red-ui-projects-dialog-file-list-entry {
        &:hover {
            background: var(--red-ui-list-item-background-hover);
        }
        
        &.selected {
            background: var(--red-ui-list-item-background-selected);
        }
    }
}

// Tree styling for file explorer 
.file-list-item {
    color: var(--red-ui-primary-text-color);
    
    &:hover {
        background-color: var(--red-ui-list-item-background-hover);
    }
    
    &.selected {
        background-color: var(--red-ui-list-item-background-selected);
        color: #ffffff;
    }
}

.red-ui-treeList {
    background: var(--red-ui-secondary-background);
    
    li {
        color: var(--red-ui-primary-text-color);
        
        &:hover {
            background: var(--red-ui-list-item-background-hover);
        }
        
        &.selected {
            background: var(--red-ui-list-item-background-selected);
            color: #ffffff;
        }
    }
}

// Dialog styling
.red-ui-editor-dialog {
    background: var(--red-ui-secondary-background);
    border: 1px solid var(--red-ui-primary-border-color);
    box-shadow: 0 0 10px var(--red-ui-shadow);
    
    .red-ui-dialog-header {
        background: var(--red-ui-tertiary-background);
        color: var(--red-ui-header-text-color);
    }
}

// Input fields
input, select, textarea {
    background-color: var(--red-ui-form-input-background);
    color: var(--red-ui-form-text-color);
    border: 1px solid var(--red-ui-form-input-border-color);
    
    &:focus {
        border-color: var(--red-ui-form-input-border-selected-color);
        box-shadow: 0 0 0 2px var(--red-ui-form-input-focus-color);
    }

    border-radius: 4px !important;
}

// Dropdown menus
.red-ui-typedInput-container {
    background: var(--red-ui-form-input-background);
    color: var(--red-ui-form-text-color);
    border-color: var(--red-ui-form-input-border-color);

    border-radius: 4px !important;
}

.red-ui-typedInput-options {
    background: var(--red-ui-secondary-background);
    border-color: var(--red-ui-primary-border-color);
    
    a {
        color: var(--red-ui-primary-text-color);
        
        &:hover {
            background: var(--red-ui-list-item-background-hover);
        }
    }
}

// Menu items
.red-ui-menu-item {
    color: var(--red-ui-primary-text-color);
    
    &:hover {
        background: var(--red-ui-list-item-background-hover);
    }
    
    &.active {
        background: var(--red-ui-list-item-background-selected);
    }
}

// Chatbot specific adjustments to match the theme
.red-ui-chatbot-message-text {
    &:hover {
        background-color: rgba(255, 255, 255, 0.05);
    }
}

.red-ui-chatbot-textarea {
    background-color: var(--red-ui-form-input-background);
    color: var(--red-ui-form-text-color);
    border-color: var(--red-ui-form-input-border-color);
    
    &:focus {
        border-color: var(--red-ui-form-input-border-selected-color);
    }
}

// Tab bar appearance
.red-ui-tabs {
    background: var(--red-ui-secondary-background);
    
    .red-ui-tab {
        color: var(--red-ui-tab-text-color-inactive);
        background: var(--red-ui-tab-background);
        
        &.active {
            color: var(--red-ui-tab-text-color-active);
            background: var(--red-ui-tab-background-active);
            border-bottom: 2px solid var(--red-ui-workspace-button-background-primary);
        }

        border-radius: 4px 4px 0 0 !important;
    }
}

// Line number styling for editor
.red-ui-editor-gutter {
    background: var(--red-ui-text-editor-gutter-background);
    color: var(--red-ui-text-editor-gutter-color);
}

// Debug panel
.red-ui-debug-content {
    background: var(--red-ui-text-editor-background);
    color: var(--red-ui-primary-text-color);
}

// List items
.red-ui-editableList {
    background: var(--red-ui-secondary-background);
    
    li {
        border-color: var(--red-ui-primary-border-color);
        
        &:hover {
            background: var(--red-ui-list-item-background-hover);
        }
        
        &.selected {
            background: var(--red-ui-list-item-background-selected);
        }
    }
}

// Table styling
table.red-ui-info-table {
    tr {
        border-color: var(--red-ui-secondary-border-color);
    }
    
    td {
        color: var(--red-ui-primary-text-color);
    }
}

// Workspace grid
#red-ui-workspace-chart {
    background-color: var(--red-ui-primary-background);
    
    .red-ui-workspace-chart-grid {
        stroke: rgba(255, 255, 255, 0.1) !important;
        stroke-width: 1px;
    }
}

// Terminal
.red-ui-debug-view {
    background: var(--red-ui-text-editor-background);
    color: var(--red-ui-primary-text-color);
    
    .red-ui-debug-msg {
        border-color: var(--red-ui-primary-border-color);
    }
}

// Terminal output syntax highlighting
.red-ui-debug-msg-payload {
    font-family: var(--red-ui-monospace-font);
    color: #d4d4d4;
    
    .red-ui-debug-msg-type-string {
        color: #ce9178;
    }
    
    .red-ui-debug-msg-type-number {
        color: #b5cea8;
    }
    
    .red-ui-debug-msg-type-boolean {
        color: #569cd6;
    }
    
    .red-ui-debug-msg-type-null {
        color: #569cd6;
    }
    
    .red-ui-debug-msg-type-meta {
        color: #6a9955;
    }
    
    .red-ui-debug-msg-type-array-bracket {
        color: #d4d4d4;
    }
    
    .red-ui-debug-msg-type-object-bracket {
        color: #d4d4d4;
    }
    
    .red-ui-debug-msg-type-key {
        color: #9cdcfe;
    }
}

// Notification styling
.red-ui-notification {
    background: var(--red-ui-secondary-background);
    color: var(--red-ui-primary-text-color);
    border-color: var(--red-ui-primary-border-color);
    box-shadow: 0 1px 4px var(--red-ui-shadow);
    
    &.red-ui-notification-warning {
        border-left: 4px solid #dcb862;
    }
    
    &.red-ui-notification-error {
        border-left: 4px solid #f44747;
    }
    
    &.red-ui-notification-success {
        border-left: 4px solid #4B8400;
    }
}

// Ensure proper coloring for generated nodes
.red-ui-palette-node {
    background: rgba(255, 255, 255, 1);
    color: var(--red-ui-primary-text-color);
    
    &:hover {
        background: rgba(255, 255, 255, 0.1);
    }
    
    .red-ui-palette-label {
        color: #FFFFFF !important; // White text in palette
    }
}

// Status styling
.red-ui-flow-node-status-label {
    color: #000000 !important; // Black text for status
}

// Make sure code in documentation is styled correctly
pre code {
    background-color: #2d2d2d !important;
    color: #d4d4d4 !important;
}

// Make node connection paths more visible
.red-ui-flow-link {
    stroke: rgba(255, 255, 255, 0.7) !important; // More visible links
}

// Ensure comment nodes have better contrast
.red-ui-flow-node-comment {
    .red-ui-flow-node-label-text {
        color: #FFFFFF;
    }
}

// Adjust node content for better readability
.red-ui-flow-node-content {
    text-shadow: 0px 0px 1px rgba(0,0,0,0.5);
}

// Add more specific node styling to ensure proper contrast

// Handle node icon colors
.red-ui-flow-node-icon {
    fill: #FFFFFF !important; // White icons for all nodes
}

// Improve node selection highlight
.red-ui-flow-node-selected {
    stroke: #ffffff !important;
    stroke-width: 2px !important;
}

// Improve port visibility
.red-ui-flow-port {
    fill: #ffffff !important;
}

// Ensure group node labels are visible
.red-ui-flow-node-group {
    .red-ui-flow-node-label {
        background-color: rgba(40, 40, 40, 0.8) !important;
        color: #FFFFFF !important;
        font-weight: bold;
    }
}

// Improve node connection lines
.red-ui-flow-link-link {
    stroke: rgba(255, 255, 255, 0.6) !important;
    stroke-width: 1.5px !important;
    
    &.red-ui-flow-link-link-active {
        stroke: #ffffff !important;
        stroke-width: 2px !important;
    }
}

// Improve node outlines
svg.red-ui-flow-node {
    stroke: rgba(255, 255, 255, 0.2);
    stroke-width: 1px;
    
    &:hover {
        stroke: rgba(255, 255, 255, 0.4);
        stroke-width: 1.5px;
    }
}

// Ensure node text doesn't get cut off
.red-ui-flow-node-label {
    margin: 4px;
    line-height: 1.4em;
}

// Update palette section headers for better visibility
.red-ui-palette-header {
    background: #1e1e1e !important;
    color: #ffffff !important;
    font-weight: 600;
    border-bottom: 1px solid #444;
}

// Ensure proper contrast for disabled nodes
.red-ui-flow-node-disabled {
    opacity: 0.6;
    
    .red-ui-flow-node-label {
        color: #bbbbbb !important;
    }
}

// Remove comment node specific styling
// Better styling for the comment node
.red-ui-flow-node-comment {
    background: rgba(120, 120, 120, 0.2) !important;
    border: 1px solid rgba(200, 200, 200, 0.3) !important;
    
    .red-ui-flow-node-label {
        color: #FFFFFF !important;
    }
}

// Apply modern fonts throughout the application
body, html {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol" !important;
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    letter-spacing: -0.01em !important;
}

// Code fonts
pre, code, .red-ui-editor, .ace_editor, .red-ui-debug-msg-type-other, .red-ui-typedInput-type {
    font-family: 'JetBrains Mono', 'SF Mono', SFMono-Regular, ui-monospace, 'DejaVu Sans Mono', Menlo, Consolas, monospace !important;
}

// Headings
h1, h2, h3, h4, h5, h6, .red-ui-header, .red-ui-palette-header, .red-ui-sidebar-header {
    font-weight: 600 !important;
    letter-spacing: -0.02em !important;
}

// Improve node text appearance
.red-ui-flow-node-label {
    font-weight: 500 !important;
    letter-spacing: -0.01em !important;
    text-shadow: 0 1px 1px rgba(0,0,0,0.1) !important;
}

// Add web font imports
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap');

// Add modern styling to all nodes - rounded corners and shadows
svg.red-ui-flow-node {
    rx: 5px !important;
    ry: 5px !important;
    filter: drop-shadow(0px 2px 3px rgba(0, 0, 0, 0.2)) !important;
    
    &:hover {
        filter: drop-shadow(0px 3px 5px rgba(0, 0, 0, 0.3)) !important;
    }
}

// Modern port styling
.red-ui-flow-port {
    stroke: rgba(0,0,0,0.15) !important;
    stroke-width: 1px !important;
    
    &:hover {
        stroke: rgba(0,0,0,0.4) !important;
    }
}

// More refined node selection style
.red-ui-flow-node-selected {
    stroke: #0e639c !important;
    stroke-width: 2px !important;
    filter: drop-shadow(0px 0px 8px rgba(14, 99, 156, 0.5)) !important;
}

// More polished node connections
.red-ui-flow-link-link {
    stroke-width: 2px !important;
    stroke: rgba(120, 120, 120, 0.7) !important;
    
    &.red-ui-flow-link-link-active {
        stroke: #0e639c !important;
        stroke-width: 2.5px !important;
    }
}

// Improve comment nodes
.red-ui-flow-node-comment {
    rx: 5px !important;
    ry: 5px !important;
    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.1)) !important;
}

// Apply web font imports
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap');
// Make ALL nodes use the same color
// svg.red-ui-flow-node {
//     background: #4A6DA7 !important;
//     fill: #4A6DA7 !important;
    
//     // Modern styling
//     rx: 5px !important;
//     ry: 5px !important;
//     filter: drop-shadow(0px 2px 3px rgba(0, 0, 0, 0.2)) !important;
    
//     &:hover {
//         filter: drop-shadow(0px 3px 5px rgba(0, 0, 0, 0.3)) !important;
//     }
    
//     // Also target the containing group that holds the icon
//     .red-ui-flow-node-icon-group {
//         rect {
//             fill: #3A5A8C !important; // Darker shade for icon container
//         }
//     }
    
//     // Update text styling to ensure consistency
//     .red-ui-flow-node-label {
//         fill: #FFFFFF !important;
//         color: #FFFFFF !important;
//         text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2) !important;
//     }
    
//     // Ensure icons are properly colored
//     .red-ui-flow-node-icon {
//         fill: #FFFFFF !important;
//     }
    
//     // Special handling for comment node
//     &.red-ui-flow-node-comment {
//         fill: rgba(74, 109, 167, 0.4) !important;
//         stroke: rgba(58, 90, 140, 0.6) !important;
        
//         .red-ui-flow-node-label-text {
//             fill: #FFFFFF !important;
//         }
//     }
// }

// More aggressive uniform node styling
// .red-ui-palette-node, 
// svg.red-ui-flow-node, 
// g.red-ui-flow-node,
// svg.red-ui-flow-node rect.red-ui-flow-node-background,
// #red-ui-workspace-chart .red-ui-flow-node {
//     &, &.red-ui-flow-node-inject, &.red-ui-flow-node-debug, &.red-ui-flow-node-function, 
//     &.red-ui-flow-node-template, &.red-ui-flow-node-delay, &.red-ui-flow-node-switch, 
//     &.red-ui-flow-node-change, &.red-ui-flow-node-range, &.red-ui-flow-node-complete, 
//     &.red-ui-flow-node-catch, &.red-ui-flow-node-status, &.red-ui-flow-node-link,
//     &.red-ui-flow-node-comment {
//         fill: #4D5B69 !important; // Modern slate blue/gray for all nodes
//         background-color: #4D5B69 !important;
//     }
// }

// Target the background rectangles specifically
rect.red-ui-flow-node-background {
    fill: #4D5B69 !important;
}

// Target icon containers
.red-ui-flow-node-icon-container, 
.red-ui-flow-node-icon {
    background-color: #3D4A58 !important;
    fill: #FFFFFF !important;
}

// // Handle potential inline SVG styles
// [class*="red-ui-flow-node-"] {
//     &[style*="fill:"] {
//         fill: #4D5B69 !important;
//     }
//     &[style*="background"] {
//         background-color: #4D5B69 !important;
//     }
// }

// // Override specific node type backgrounds with !important
// .red-ui-flow-node-inject,
// .red-ui-flow-node-debug,
// .red-ui-flow-node-complete,
// .red-ui-flow-node-function,
// .red-ui-flow-node-template,
// .red-ui-flow-node-delay,
// .red-ui-flow-node-switch,
// .red-ui-flow-node-change,
// .red-ui-flow-node-range,
// .red-ui-flow-node-catch,
// .red-ui-flow-node-status,
// .red-ui-flow-node-link,
// .red-ui-flow-node-comment {
//     background: #4D5B69 !important;
//     fill: #4D5B69 !important;
// } 
